<%- include('partials/header', { title: 'Search Businesses', currentPage: 'search', stylesheets: ['searchbiz.css'] }) %>

<main class="search-page-main">

<!-- 1. BANNER -->
<section class="search-banner">
    <h1>Find Your Next Local Gem</h1>
    <p>Search for any business, category, or service in your city.</p>
</section>

<!-- 2. LARGE FILTER BAR -->
<section class="search-controls-container">
    <div class="search-controls">
        <div class="filter-group">
            <label for="searchInput">Search by Name</label>
            <input type="text" id="searchInput" placeholder="e.g., Cafe, Plumber...">
        </div>
        
        <div class="filter-group">
            <label for="filtercat">Category</label>
            <select id="filtercat">
                <option value="All">All Categories</option>
                <% if (typeof categories !== 'undefined') { %>
                  <% categories.forEach(category => { %>
                    <option value="<%= category.name %>"><%= category.name %></option>
                  <% }) %>
                <% } %>
            </select>
        </div>
        
        <div class="filter-group">
            <label for="filterstar">Rating</label>
            <select id="filterstar">
                <option value="all">All Ratings</option>
                <option value="4-5">⭐ 4 Stars & Up</option>
                <option value="3-5">⭐ 3 Stars & Up</option>
                <option value="2-5">⭐ 2 Stars & Up</option>
            </select>
        </div>
        
        <div class="filter-group">
            <label for="sortOrder">Sort By</label>
            <select id="sortOrder">
                <option value="desc">Highest Rated</option>
                <option value="asc">Lowest Rated</option>
            </select>
        </div>

        <button id="applyFiltersBtn" class="filter-btn">Search</button>
    </div>
</section>

<!-- 3. RESULTS AREA -->
<section class="results-area">
    <h2 id="results-heading">Showing all businesses</h2>
    
    <!-- 3-Column Grid Container -->
    <div class="business-grid" id="topbuss">
        <!-- Business cards will be rendered here -->
    </div>

    <!-- 5. "LOAD MORE" BUTTON -->
    <div class="pagination-controls" id="pagination-controls">
        <button id="load-more-btn">Load More</button>
    </div>
</section>


</main>

<script>
// Pass businesses data from server to client
const businessesData = <%- JSON.stringify(businesses || []) %>;
</script>

<%- include('partials/footer', { scripts: ['utils.js', 'searchbiz.js'] }) %>