<%- include('partials/header', { title: 'CityBiz Directory', currentPage: 'home', stylesheets: ['mainstyles.css'] }) %>

<main>
    <div style="display: flex; justify-content: center;"><h1 class="heading">Top 4 Businesses In Your City</h1></div>
    <div class="topbuss" id="topbuss"></div>
    
    <section class="category-section">
        <div style="display: flex; justify-content: center;"><h2 class="category-heading heading">Browse by Category</h2></div>
        
        <div class="category-grid">
          <% if (typeof categories !== 'undefined' && categories.length > 0) { %>
            <% categories.forEach(category => { %>
              <a href="/search?categoryId=<%= category.category_id %>" class="category-card">
                <%= category.name %>
              </a>
            <% }) %>
          <% } else { %>
            <p>No categories found.</p>
          <% } %>
        </div>
        </section>
</main>

<script>
    // Pass businesses data from server to client
    // This '|| []' prevents errors if 'businesses' is ever null or undefined
    const businesses = <%- JSON.stringify(businesses || []) %>;
</script>

<%- include('partials/footer', { scripts: ['utils.js', 'mainpage.js'] }) %>