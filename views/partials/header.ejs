<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= title %></title>
    <link rel="stylesheet" href="/css/common.css">
    <!-- Dynamically insert other stylesheets -->
    <% if (typeof stylesheets !== 'undefined' && stylesheets) { %>
        <% stylesheets.forEach(sheet => { %>
            <link rel="stylesheet" href="/css/<%= sheet %>">
        <% }) %>
    <% } %>
</head>
<body>
    <header class="site-header">
        <div class="header-container">
            <a href="/">
                <img src="https://res.cloudinary.com/djqtmil10/image/upload/v1762545131/Gemini_Generated_Image_c9iyuhc9iyuhc9iy-Photoroom_wc9p7s.png" id="logo" alt="CityBiz Logo">
            </a>
            <nav class="navbar">
                <ul class="options">
                    
                    <!-- === SHARED PUBLIC LINKS === -->
                    <li id="<%= currentPage === 'home' ? 'current' : '' %>">
                        <a href="/">HOME</a>
                    </li>
                    <li id="<%= currentPage === 'search' ? 'current' : '' %>">
                        <a href="/search">SEARCH</a>
                    </li>

                    <li id="<%= currentPage === 'about' ? 'current' : '' %>">
                        <a href="/about">ABOUT</a>
                    </li>

                    <!-- === DYNAMIC USER LINKS === -->
                    <% if (locals.user) { %>
                        
                        <!-- 1. ADMIN NAVBAR -->
                        <% if (locals.user.role === 'admin') { %>
                            <li id="<%= currentPage === 'admin' ? 'current' : '' %>">
                                <a href="/admin">ADMIN DASH</a>
                            </li>
                        <% } %>

                        <!-- 2. OWNER NAVBAR -->
                        <% if (locals.user.role === 'owner') { %>
                            <li id="<%= currentPage === 'dashboard' ? 'current' : '' %>">
                                <a href="/dashboard/owner">MY DASHBOARD</a>
                            </li>
                            <li id="<%= currentPage === 'add' ? 'current' : '' %>">
                                <a href="/add">ADD BUSINESS</a>
                            </li>
                        <% } %>

                        <!-- 3. VIEWER NAVBAR -->
                        <% if (locals.user.role === 'viewer') { %>
                            <% if (locals.user && locals.user.role === 'viewer') { %>
    <li id="<%= currentPage === 'favorites' ? 'current' : '' %>">
        <a href="/favorites">MY FAVORITES</a>
    </li>
    <li id="<%= currentPage === 'reviews' ? 'current' : '' %>">
        <a href="/reviews">MY REVIEWS</a>
    </li>
<% } %>
                        <% } %>
                            <li id="<%= currentPage === 'profile' ? 'current' : '' %>">
                            <a href="/profile">MY PROFILE</a>
                        </li>
                        <!-- LOGOUT (for all logged-in users) -->
                        <li class="auth-links">
                            <a href="#" id="logout-btn">LOGOUT</a>
                        </li>

                    <% } else { %>
                        
                        <!-- 4. GUEST NAVBAR (Logged Out) -->
                        <li class="auth-links" id="<%= currentPage === 'login' ? 'current' : '' %>">
                            <a href="/login">LOGIN</a>
                        </li>
                        <li id="<%= currentPage === 'register' ? 'current' : '' %>">
                            <a href="/register">REGISTER</a>
                        </li>
                    <% } %>
                </ul>
            </nav>
        </div>
    </header>